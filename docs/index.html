

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>RLStructures - A platform for developping new RL algorithms &mdash; RLStructures  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Data Structures" href="gettingstarted/DataStructures.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home" alt="Documentation Home"> RLStructures
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted/DataStructures.html">Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted/Environments.html">Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted/Agent.html">Agents/Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="rlstructures.html">rlstructures API</a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/index.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">RLStructures</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>RLStructures - A platform for developping new RL algorithms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rlstructures-a-platform-for-developping-new-rl-algorithms">
<h1>RLStructures - A platform for developping new RL algorithms<a class="headerlink" href="#rlstructures-a-platform-for-developping-new-rl-algorithms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="quick-start">
<h2>Quick start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<p><cite>rlstructures</cite> is a Python 3.6+ library.</p>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted/DataStructures.html">Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted/Environments.html">Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted/Agent.html">Agents/Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="rlstructures.html">rlstructures API</a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/index.html">API Reference</a></li>
</ul>
</div>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Classical Deep Learning (DL) algorithms are optimizing a loss function defined over training dataset. The implementation of such a training loop is quite simple.
Moreover, the computation can be easily speed-up by i) using GPUs for the loss and gradient computations, ii) by using multi-processes DataLoaders to deal with large amounts of data.</p>
<p><em>Can we do the same in Reinforcement Learning? This is the objective of RLStructures.</em></p>
<p>The main difference between classical DL approaches and Reinforcement Learning ones is
in the way data are acquired. While in DL batches come from a dataset, in RL, learning data come from the interaction between policies and an environments. Moreover, the nature of the collected information is usually more complex, structured as sequences, and involving multiple variables (e.g observations, actions, internal state of the policies, etc…), particularly when considering complex policies like hierarchical ones, mixtures, etc….</p>
<p>RLStructures is a library focused on making the implementation of RL algorithms <strong>as simple as possible</strong>, providing  tools allowing users to write RL learning loops easily. Indeed, RLStructures will take care of simulating the interations between multiple policies and multiple agents at scale and will return a simple data structure on which loss computation is easy. <strong>RLStructures is not a library of RL algorithms</strong> (even if some algorithms are provided to illustrate how it can be used in practical cases.) and can be used in any setting where policies interact with  environments, and when <strong>the user need to do it at scale</strong>, including unsupervised RL, meta-RL, multitask RL, etc….</p>
<p>RLStructures is based on three components that have been made as easy as possible to facilitate the use of the library:</p>
<ul class="simple">
<li><p>A generic data structure (DictTensor) encoding (batches of) information exchanged between the agent and the environment. In addition, we provide a temporal version of this structure (TemporalDictTensor) encoding (batches of) sequences of DictTensor, the sequences being of various lengths</p></li>
<li><p>An Agent API allowing to implement complex agents (with or without using pytorch  models) with complex outputs and internal states (e.g hierarchical agents, transformers-based agents, …). The API also allows the user to specify which information as to be stored to allow future computations.</p></li>
<li><p>A set of Batchers where a batcher handles the execution of multiple agents over multiple environments and produces as an output a data structure (TemporalDictTensor) that will be easily usable for computation. By using multi-processes batchers, the user will easily scale his/her algorithm to multiple environments, multiple policies on multiple cores. Moreover, since batchers can be executed asynchronuously, the user will be able to colect interactions between agents and environments while executing some other computations in parallel.</p></li>
</ul>
<p>Note that multiple GPUs and CPUs can be used (but examples are provided with batchers on CPUs, and learning algorithm on CPU or GPU)</p>
<p>Moreover, RLStructures proposes:</p>
<ul class="simple">
<li><p>A set of classical algorithms (A2C, PPO, DDQN and SAC)</p></li>
<li><p>A simple logger allowing to monitor results on tensorboard, but also to generate CSV files for future analysis</p></li>
</ul>
</div>
<div class="section" id="learning-to-use-rlstructures">
<h2>Learning to use RLStructures<a class="headerlink" href="#learning-to-use-rlstructures" title="Permalink to this headline">¶</a></h2>
<p>Learning RLStructures can be made in a very few hours (from the feedback from multiple users). It involves the following steps (see the rlstructures/tutorial examples)</p>
<ul class="simple">
<li><p>Learning about <strong>DictTensor</strong> and <strong>TemporalDictTensor</strong> that are the two data structures used everywhere in RLStructures <strong>(15 minutes)</strong></p></li>
<li><p>Learning about mapping a Gym Environment to a <strong>RLStructure Environment</strong> <strong>(5 minutes)</strong></p></li>
<li><p>Learning about the <strong>Agent API</strong> allowing one to implement any agent, including recurrent agents <strong>(30 minutes)</strong></p></li>
<li><p>Learning about creating and using <strong>multi-processes batchers</strong> (i.e Batcher and EpisodeBatcher) <strong>(15 minutes)</strong>  – see [Episode Batcher Tutorial](doc/MultiProcessEpisodeBatcher.md) and [Trajectory Batcher Tutorial](doc/MultiProcessTrajectoryBatcher.md)</p></li>
</ul>
<p>Now, you can execute a complex policy over an environment in a multi-thread way, and get a simple data structure as an output on which you can compute any complex loss and gradients.</p>
<p>To go deeper in the library, next steps are:</p>
<ul class="simple">
<li><p>How to use batchers in non-blocking modes (for instance for computing evaluation metrics while learning using other processes)</p></li>
<li><p>How to manage  multiple types of environments and multiple types of agents in a same batcher (e.g goal-oriented policies, multitask environments, managing stochastic and deterministic vesions of a same policy, etc.. )</p></li>
<li><p>How an agent can access its whole history (e.g to implement Transformers-based policies)</p></li>
<li><p>Understanding the RLStructures Env API (not needed to develop new algorithms, but may be needed to implement new and fast environments without using openAI gym)</p></li>
</ul>
<p>For these additional steps, the best way is to look at the implementation of the examples algorithms.</p>
</div>
<div class="section" id="provided-algorithms-as-examples">
<h2>Provided algorithms (as examples)<a class="headerlink" href="#provided-algorithms-as-examples" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>We provide multiple implementations of RL algorithms in the <cite>rlaglos</cite> package as illustrative examples. Note that these algorithms have been benchmarked on simple environments only.</dt><dd><ul class="simple">
<li><p>A2C for discrete action space (using recurrent or not recurrent architectures) with GAE (i.e including REINFORCE)</p></li>
<li><p>PPO for discrete action space (using recurrent or not recurrent architectures)</p></li>
<li><p>Dueling DQN for discrete action space (using not recurrent architectures)</p></li>
<li><p>SAC for continous action space (using not recurrent architectures)</p></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="citing">
<h2>Citing<a class="headerlink" href="#citing" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bibtex notranslate"><div class="highlight"><pre><span></span><span class="nc">@misc</span><span class="p">{</span><span class="nl">rlstructures</span><span class="p">,</span>
    <span class="na">author</span> <span class="p">=</span> <span class="s">{L. Denoyer, D. Rothermel and X. Martinet}</span><span class="p">,</span>
    <span class="na">title</span> <span class="p">=</span> <span class="s">{{RLStructures - A simple library for RL research}}</span><span class="p">,</span>
    <span class="na">year</span> <span class="p">=</span> <span class="s">{2021}</span><span class="p">,</span>
    <span class="na">publisher</span> <span class="p">=</span> <span class="s">{GitHub}</span><span class="p">,</span>
    <span class="na">journal</span> <span class="p">=</span> <span class="s">{GitHub repository}</span><span class="p">,</span>
    <span class="na">howpublished</span> <span class="p">=</span> <span class="s">{\url{https://GitHub.com/FacebookResearch/rlstructures}}</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p><code class="code docutils literal notranslate"><span class="pre">RLStructures</span></code> is released under the MIT license. See <a class="reference external" href="https://github.com/facebookresearch/rlstructures/blob/master/LICENSE">LICENSE</a> for additional details about it, as well as our <a class="reference external" href="https://opensource.facebook.com/legal/terms">Terms of Use</a> and <a class="reference external" href="https://opensource.facebook.com/legal/privacy">Privacy Policy</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="gettingstarted/DataStructures.html" class="btn btn-neutral float-right" title="Data Structures" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, Facebook AI Research

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>